(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t,a){},106:function(e,t,a){},181:function(e,t){},184:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(72),c=a.n(l),s=(a(82),a(1)),o=a(14),i=a(4),m=a(2),u=a.n(m),d=a(6),f=a(3),v=a.n(f),p=a(26),g=a(11),x=function(e){var t=Object(n.useState)(e),a=Object(s.a)(t,2),r=a[0],l=a[1];return[r,function(e){return l(Object(g.a)(Object(g.a)({},r),{},Object(p.a)({},e.target.name,e.target.value)))}]};a(101);function h(e){var t=e.msg;return r.a.createElement("div",{className:"loading"},r.a.createElement("div",{className:"loadingio-spinner-eclipse-tl18qrapo1f"},r.a.createElement("div",{className:"ldio-u6wmgzlxuh9"},r.a.createElement("div",null))),t&&r.a.createElement("h1",null,t))}var w=Object(n.createContext)({user:{},isLoggedin:!1,isAdmin:!1,setUser:function(){},setIsLoggedin:function(){},setIsAdmin:function(){}}),b=Object(n.createContext)({chat:{},receiver:{},chatList:[],setChat:function(){},setReceiver:function(){},setChatList:function(){}});function E(){var e=Object(n.useContext)(w),t=e.setIsLoggedin,a=e.setUser,l=(e.setIsAdmin,x({email:"",password:""})),c=Object(s.a)(l,2),m=c[0],f=c[1],p=Object(n.useState)(""),g=Object(s.a)(p,2),b=g[0],E=g[1],y=Object(n.useState)(!1),N=Object(s.a)(y,2),j=N[0],O=N[1],C=Object(i.g)(),k=(Object(i.h)().state||{from:{pathname:"/messages"}}).from,L=function(){var e=Object(d.a)(u.a.mark((function e(n){var r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,O(!0),r={headers:{"Content-Type":"application/json"}},e.next=6,v.a.post("/api/v1/user/login",m,r);case 6:200===(l=e.sent).status&&l.data.user&&(a(l.data.user),t(!0),C.replace(k)),O(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response&&400===e.t0.response.status&&E(e.t0.response.data.message),O(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"mt-4 mx-auto flex justify-center items-center text-gray-600"},r.a.createElement("div",{className:"mx-8"},r.a.createElement("h1",{className:"font-bold text-4xl ml-4"},"Login"),r.a.createElement("form",{className:"my-4",onSubmit:function(e){return L(e)}},r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-1 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})),r.a.createElement("input",{type:"email",placeholder:"Enter email",className:"w-44 bg-transparent outline-none ml-2 text-sm",onChange:function(e){return f(e)},name:"email"})),r.a.createElement("small",{className:"text-gray-400 text-xs"},"We'll never share your email with anyone else."),r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-2 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})),r.a.createElement("input",{onChange:function(e){return f(e)},type:"password",name:"password",placeholder:"Enter password",className:"w-44 bg-transparent outline-none ml-2 text-sm"})),r.a.createElement("small",{className:"h-16 text-xs text-red-400"},b),j?r.a.createElement(h,null):r.a.createElement("button",{className:"block mt-4 text-center p-2 w-48 bg-purple-600 rounded-md text-white m-auto",type:"submit"},"connect"),r.a.createElement("p",{className:"text-xs text-gray-400 m-4 text-center"},"Dont have an account",r.a.createElement(o.b,{className:"text-purple-700 mr-2",to:"/register"},"Creat an account")))))}a(106);function y(){var e=Object(n.useContext)(w),t=e.setIsAdmin,a=e.setUser,l=e.setIsLoggedin,c=Object(n.useState)(!1),m=Object(s.a)(c,2),f=m[0],p=m[1],g=Object(i.g)(),x=function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,v.a.get("/api/v1/user/logout");case 4:200===e.sent.status&&(g.push("/login"),a(null),l(!1),t(!1)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"md:hidden"},f?r.a.createElement("svg",{onClick:function(){return p(!1)},className:"cursor-pointer w-6 h-6 absolute top-2 right-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})):r.a.createElement("svg",{onClick:function(){return p(!0)},className:"cursor-pointer w-6 h-6 absolute top-2 right-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"}))),r.a.createElement("nav",{style:{backgroundColor:"#050646",minHeight:"400px"},className:"z-50 fixed ".concat(f?"left-2":"-left-20","\n        md:h-auto md:static flex-none flex py-8 rounded-xl shadow-md w-16 flex-col justify-between items-center")},r.a.createElement("div",{className:"flex flex-col space-y-8"},r.a.createElement(o.b,{to:"/messages"},r.a.createElement("div",{className:"mx-auto w-6 h-6 rounded-md text-gray-100"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"}))),r.a.createElement("div",{className:"text-center text-xs mt-1 text-gray-200"},"Home")),r.a.createElement(o.b,{to:"/setting"},r.a.createElement("div",{className:"mx-auto w-6 h-6 rounded-md text-gray-100"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"}))),r.a.createElement("div",{className:"text-center text-xs mt-1 text-gray-200"},"Setting"))),r.a.createElement("div",null,r.a.createElement("div",{className:"cursor-pointer hover:bg-blue-900",onClick:function(e){return x(e)}},r.a.createElement("div",{className:"mx-auto w-6 h-6 rounded-md text-gray-100"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"}))),r.a.createElement("div",{className:"text-center text-xs mt-1  text-gray-200"},"logout")))))}function N(e){var t=e.children;return r.a.createElement("main",{className:"bg-gray-100"},r.a.createElement("div",{className:"relative flex p-3 md:space-x-2 min-h-screen"},t))}function j(e){var t=e.user,a=e.data,n=e.loadChat;return r.a.createElement("div",{className:"bg-white rounded-lg p-2 my-2 cursor-pointer",onClick:function(){return n(a._id)}},r.a.createElement("div",{className:"flex items-center justify-between"},r.a.createElement("div",{className:"flex items-center space-x-2"},r.a.createElement("div",{className:"w-2 h-2 ".concat(a.receiver.login?"bg-red-400":"bg-transparent"," rounded-full")}),r.a.createElement("div",{className:"w-8 h-8 rounded-full overflow-hidden"},r.a.createElement("img",{src:a.receiver.profile_img,className:"object-cover h-8 w-8",alt:"".concat(a.receiver.name," profile pic")})),r.a.createElement("div",null,r.a.createElement("div",{className:"font-bold text-gray-600"},a.receiver.name),r.a.createElement("div",{className:"text-xs text-gray-400"},"online"))),a.lastMsg&&r.a.createElement("div",{className:"text-xs text-gray-400"},function(e){var t=new Date(e);return"".concat(t.getHours(),":").concat(t.getMinutes())}(a.lastMsg.send_Date))),r.a.createElement("div",{className:"flex flex-row items-start justify-between px-4 py-2"},r.a.createElement("div",{className:"text-xs text-gray-500 "},a.lastMsg?a.lastMsg.sender===t._id?"You: ".concat(a.lastMsg.body):a.lastMsg.body:"Say hi to ".concat(a.receiver.name)),r.a.createElement("div",{className:"w-4 h-4 text-gray-400"},a.lastMsg&&"sending"===a.lastMsg.status?r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})):null)))}function O(e){var t=e.receiver,a=Object(n.useContext)(b).setChat;return r.a.createElement("div",{className:"h-20 px-4 border-b-2 flex flex-row flex-none justify-between items-center relative"},r.a.createElement("div",{className:"flex flex-row items-center"},r.a.createElement("div",{className:"w-10 h-10 flex-none rounded-full overflow-hidden"},r.a.createElement("img",{src:t.profile_img,className:"object-cover h-10 w-10",alt:""})),r.a.createElement("div",{className:"ml-2"},r.a.createElement("div",{className:"text-lg font-bold text-gray-600"},t.name),r.a.createElement("div",{className:"text-xs text-gray-400"},"Last seen 1 day ago"))),r.a.createElement("div",{className:"space-x-2 flex flex-row items-center"},r.a.createElement("div",{className:"cursor-pointer w-8 h-8 rounded-full border flex items-center justify-center"},r.a.createElement("svg",{className:"w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"}))),r.a.createElement("div",{className:"cursor-pointer w-8 h-8 rounded-full border flex items-center justify-center",onClick:function(){return a(null)}},r.a.createElement("svg",{className:"w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})))))}var C=a(22);function k(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useContext)(b),o=c.chat,i=c.setChat,m=(c.setChatList,c.chatList,Object(n.useContext)(w).user),f=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==a.length){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,n={_id:"msg"+Math.floor(1e4*Math.random()),chat_id:o._id,body:a,sender:m._id,send_Date:Date.now(),status:"sending"},i(Object(g.a)(Object(g.a)({},o),{},{messages:[].concat(Object(C.a)(o.messages),[n])})),l(""),e.next=9,v.a.post("/api/v1/chat/message",n);case 9:201===e.sent.status&&console.log("msg saved"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{className:" bg-white border-t-2 flex flex-row items-center space-x-4 h-16 px-2"},r.a.createElement("div",{className:"hidden md:flex cursor-pointer w-8 h-8 rounded-full border  items-center justify-center"},r.a.createElement("svg",{className:"w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z",clipRule:"evenodd"}))),r.a.createElement("input",{type:"text",placeholder:"write a message",className:"flex-auto outline-none",onChange:function(e){return l(e.target.value)},value:a}),r.a.createElement("div",{className:"hidden md:flex  cursor-pointer w-8 h-8 rounded-full border  items-center justify-center"},r.a.createElement("svg",{className:"hidden md:block w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"}))),r.a.createElement("svg",{className:" cursor-pointer w-6 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})),r.a.createElement("button",{type:"submit",style:{backgroundColor:"#4c60f2"},className:"outline-none cursor-pointer w-10 h-10 shadow-lg rounded-full border flex flex-none items-center justify-center",onClick:function(e){return f(e)}},r.a.createElement("svg",{className:"w-5 text-white rotate-90 transform",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"}))))}function L(){var e=Object(n.useContext)(b),t=e.setChat,a=e.setChatList,l=e.setReceiver,c=e.chatList,o=Object(n.useContext)(w).user,i=Object(n.useState)(""),m=Object(s.a)(i,2),f=m[0],p=m[1],g=Object(n.useState)(!1),x=Object(s.a)(g,2),h=x[0],E=x[1],y=Object(n.useState)([]),N=Object(s.a)(y,2),O=N[0],C=N[1],k=Object(n.useState)([]),L=Object(s.a)(k,2),M=L[0],_=L[1],z=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 10,1,e.prev=2,e.next=5,v.a.get("/api/v1/chat?limit=".concat(10,"&offset=").concat(1));case 5:200===(t=e.sent).status&&(a(t.data),0!==t.data.length&&window.innerWidth>=768&&H(t.data[0]._id)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/v1/user/suggestion");case 3:200===(t=e.sent).status&&_(t.data.users),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v.a.post("/api/v1/user/search",{search:f});case 4:200===(a=e.sent).status&&C(a.data.users),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(d.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/v1/chat/receiver/".concat(a));case 3:200===(n=e.sent).status&&(t(n.data),C([])),C([]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(d.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 10,0,e.prev=2,e.next=5,v.a.get("/api/v1/chat/".concat(a,"?limit=").concat(10,"&offset=").concat(0));case 5:200===(n=e.sent).status&&(t(n.data),l(n.data.receiver),C([])),C([]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0.response);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){z(),R()}),[]),r.a.createElement(r.a.Fragment,null,h&&r.a.createElement("div",{className:"absolute top-0 left-0 z-40 h-full w-full",style:{background:"#00000033"},onClick:function(){return E(!1)}}),r.a.createElement("div",{className:"mt-8 md:mt-0 w-full md:w-72 h-full overflow-auto flex-none",style:{height:"calc(100vh - 2rem)"}},r.a.createElement("div",{className:"relative mx-2 z-40"},r.a.createElement("form",{onSubmit:function(e){return S(e)},className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3  rounded-md"},r.a.createElement("button",{type:"submit",className:"cursor-pointer"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"}))),r.a.createElement("input",{type:"text",placeholder:"Search...",className:"bg-transparent outline-none ml-2 text-sm w-full",onChange:function(e){return p(e.target.value)},onFocus:function(){return E(!0)}})),0!==O.length&&r.a.createElement("ul",{className:" bg-white border-2 border-gray-200  rounded-md shadow-lg absolute w-full mt-1 overflow-y-auto",style:{maxHeight:"200px"}},O.map((function(e){return r.a.createElement("li",{key:"search_user_".concat(e._id),className:"cursor-pointer hover:bg-gray-100 py-2 px-3 ",onClick:function(){E(!1),B(e._id)}},r.a.createElement("div",{className:"text-gray-600"},e.name),r.a.createElement("div",{className:"text-sm text-gray-400"},e.email))})))),r.a.createElement("section",{className:"pl-2 pt-4"},r.a.createElement("div",{className:"flex flex-row items-center mb-4 space-x-3"},r.a.createElement("h2",{className:"font-bold text-3xl"},"Inbox"),r.a.createElement("div",{className:"text-xs border text-red-400 border-red-400 bg-red-100 rounded-full px-2 py-1 font-bold"},"4 new")),o&&r.a.createElement("div",{className:"m-4"},o.name),r.a.createElement("div",null,0!==c.length&&c.map((function(e){return r.a.createElement(j,{key:e._id,data:e,loadChat:H,user:o})}))),0!==M.length&&r.a.createElement("div",null,r.a.createElement("h1",{className:"font-bold mb-4 text-gray-900 text-sm pb-1 border-b-2 border-gray-600"},"suggestions"),M.map((function(e){return r.a.createElement("div",{onClick:function(){return B(e._id)},className:"flex flex-row items-center cursor-pointer hover:bg-gray-200 p-2 transition-colors space-x-2 my-1"},r.a.createElement("div",{className:"w-8 h-8 rounded-full overflow-hidden"},r.a.createElement("img",{src:e.profile_img,alt:"".concat(e.name," profile picture"),className:"w-8 h-8 object-cover"})),r.a.createElement("div",null,r.a.createElement("div",{className:"text-gray-600"},e.name),r.a.createElement("div",{className:"text-sm text-gray-400"},e.email)))}))))))}var M=a(74),_=a.n(M);function z(e){var t=e.chat,a=Object(n.useContext)(w).user;return r.a.createElement("div",{className:"flex flex-col absolute z-40 md:z-20 top-0 left-0 h-full w-full md:w-auto md:relative rounded-md bg-white border-none md:border-2 border-gray-200 flex-auto md:h-auto"},t.receiver&&r.a.createElement(O,{receiver:t.receiver}),r.a.createElement("div",{id:"chat_body",style:{height:"calc(100vh - 11rem)"},className:" flex-auto"},r.a.createElement(_.a,{className:"w-full h-full"},0!==t.messages.length?t.messages.map((function(e){return r.a.createElement("div",{key:e._id,className:e.sender===a._id?"my-2 cursor-pointer flex flex-row-reverse items-start ".concat("sending"===e.status&&"opacity-50"):"my-2 cursor-pointer flex flex-row items-start"},r.a.createElement("div",{className:"w-8 h-8 rounded-full overflow-hidden mx-2"},r.a.createElement("img",{src:e.sender===a._id?a.profile_img:t.receiver.profile_img,className:"object-cover h-8 w-8",alt:""})),r.a.createElement("div",null,r.a.createElement("div",{className:"border rounded-md bg-gray-100 text-gray-400 py-1 px-2 ",style:{maxWidth:"16rem",width:"fit-content"}},e.body),r.a.createElement("div",{className:e.sender===a._id?"text-xs text-gray-500 pt-2 text-right":"text-xs text-gray-500 pt-2",style:{display:"none"}},function(e){var t=new Date(e);return"".concat(t.getHours(),":").concat(t.getMinutes())}(e.send_Date))))})):r.a.createElement("div",{className:"text-center text-smtext-gray-500 font-bold my-2"},"Say hi to ".concat(t.receiver.name)))),r.a.createElement(k,null))}function R(e){var t=e.receiver;return r.a.createElement("div",{className:"hidden xl:block absolute right-0 top-0 shadow-2xl xl:static rounded-md xl:shadow-none w-full bg-white border-2 md:w-80"},r.a.createElement("div",{className:"h-20 border-b-2 py-2 px-4 flex justify-between items-center"},r.a.createElement("div",{className:"font-bold text-gray-600 text-2xl"},"Profile"),r.a.createElement("div",{className:"cursor-pointer w-8 h-8 rounded-full border flex items-center justify-center"},r.a.createElement("svg",{className:"w-4 text-gray-200",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})))),r.a.createElement("div",{className:"flex flex-col items-center pt-8"},r.a.createElement("div",{className:"w-32 h-32 shadow-xl rounded-full overflow-hidden"},r.a.createElement("img",{src:t.profile_img,className:"object-cover h-32 w-32",alt:""})),r.a.createElement("div",{className:"font-bold text-xl text-gray-600 pt-4"},t.name),r.a.createElement("div",{className:"text-blue-700"},t.email),r.a.createElement("div",{className:"text-sm text-gray-400"},t.phone),r.a.createElement("div",{className:"mt-1 text-sm text-gray-400"},t.location),r.a.createElement("div",{className:"flex items-center border-t-2 border-b-2 w-full px-4 py-4"},r.a.createElement("div",{className:"font-bold mr-2 text-gray-600 text-sm"},"6.4 Rating"),r.a.createElement("div",{className:"inline-block"},r.a.createElement("div",{className:"flex flex-row"},r.a.createElement("svg",{className:"w-6 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})),r.a.createElement("svg",{className:"w-6 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})),r.a.createElement("svg",{className:"w-6 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})),r.a.createElement("svg",{className:"w-6 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})),r.a.createElement("svg",{className:"w-6 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})))))))}function S(){var e=Object(n.useContext)(b),t=e.chat,a=e.receiver;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement(L,null),t&&r.a.createElement(z,{chat:t}),t&&a&&r.a.createElement(R,{receiver:a}))}function B(){var e=Object(n.useContext)(w),t=e.setUser,a=e.setIsLoggedin,l=(e.setIsAdmin,x({name:"",email:"",password:"",cPassword:""})),c=Object(s.a)(l,2),o=c[0],m=c[1],f=Object(n.useState)(""),p=Object(s.a)(f,2),g=p[0],b=p[1],E=Object(n.useState)(!1),y=Object(s.a)(E,2),N=y[0],j=y[1],O=Object(i.g)(),C=function(){var e=Object(d.a)(u.a.mark((function e(n){var r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,j(!0),r={headers:{"Content-Type":"application/json"}},console.log("sending req"),e.next=7,v.a.post("/api/v1/user/register",o,r);case 7:200===(l=e.sent).status&&(t(l.data.user),a(!0),j(!1),O.replace("/messages")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response&&400===e.t0.response.status&&b(e.t0.response.data.message),j(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"mt-10 mx-auto flex justify-center items-center text-gray-600"},r.a.createElement("div",{className:"mx-8"},r.a.createElement("h1",{className:"font-bold text-4xl ml-4"},"Register"),r.a.createElement("form",{className:"my-4",onSubmit:function(e){return C(e)}},r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-1 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})),r.a.createElement("input",{type:"text",placeholder:"Full name",className:"w-44 bg-transparent outline-none ml-2 text-sm",onChange:function(e){return m(e)},name:"name"})),r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-1 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})),r.a.createElement("input",{type:"email",placeholder:"Enter email",className:"w-44 bg-transparent outline-none ml-2 text-sm",onChange:function(e){return m(e)},name:"email",autoComplete:!1})),r.a.createElement("small",{className:"text-gray-400 text-xs"},"We'll never share your email with anyone else."),r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-2 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})),r.a.createElement("input",{onChange:function(e){return m(e)},type:"password",name:"password",placeholder:"Enter password",className:"w-44 bg-transparent outline-none ml-2 text-sm"})),r.a.createElement("div",{className:"flex flex-row items-center bg-white border-2 border-gray-200 py-2 px-3 mb-2 mt-4 rounded-md"},r.a.createElement("svg",{className:"w-5 flex-none text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})),r.a.createElement("input",{onChange:function(e){return m(e)},type:"password",name:"cPassword",placeholder:"Confirme password",className:"w-44 bg-transparent outline-none ml-2 text-sm"})),r.a.createElement("small",{className:"h-16 text-xs text-red-400"},g),N?r.a.createElement(h,null):r.a.createElement("button",{className:"block mt-4 text-center p-2 w-48 bg-purple-600 rounded-md text-white m-auto",type:"submit"},"Register"))))}function H(){var e=Object(n.useContext)(w),t=e.user,a=e.setUser,l=x(t),c=Object(s.a)(l,2),o=c[0],i=c[1],m=Object(n.useState)(!1),u=Object(s.a)(m,2),d=u[0],f=u[1],p=Object(n.useState)(null),g=Object(s.a)(p,2),b=g[0],E=g[1],N=Object(n.useState)(null),j=Object(s.a)(N,2),O=j[0],C=j[1],k=Object(n.useState)(null),L=Object(s.a)(k,2),M=L[0],_=L[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement("section",{className:"flex-auto"},r.a.createElement("div",{className:"md:w-2/3 lg:w-3/5 mt-8 mx-auto"},r.a.createElement("div",{className:"flex flex-col md:flex-row items-center  md:space-x-10"},r.a.createElement("div",{className:"relative w-28"},r.a.createElement("label",{htmlFor:"file"},r.a.createElement("svg",{className:"w-6 h-6 rounded-full p-1 cursor-pointer bg-indigo-700 text-white absolute bottom-0 right-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},r.a.createElement("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"}))),r.a.createElement("div",{className:"w-28 h-28 shadow-xl rounded-full overflow-hidden "},r.a.createElement("img",{src:M||o.profile_img,className:"object-cover h-28 w-28",alt:""}))),r.a.createElement("div",{className:"mt-4 text-center md:text-left"},r.a.createElement("h1",{className:"text-gray-800 text-2xl font-bold"},t.name),r.a.createElement("p",{className:"text-gray-300 text-sm"},t.bio))),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),f(!0);var t=new FormData;t.append("file",O),null!=O&&v.a.post("/api/v1/user/upload_pic",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){f(!1)})).catch((function(e){f(!1),400===e.response.status?E(e.response.data.message):E("oops somthing went wrong!")})),v.a.post("/api/v1/user/information",{values:o}).then((function(e){f(!1),a(e.data.user)})).catch((function(e){f(!1),console.log(e),E(e)}))}(e)}},r.a.createElement("input",{type:"file",name:"file",onChange:function(e){C(e.target.files[0]),_(URL.createObjectURL(e.target.files[0]))},id:"file",className:"hidden"}),r.a.createElement("div",{className:"grid md:grid-cols-2 md:grid-row-2 gap-4 mt-10 justify-items-center"},r.a.createElement("div",null,r.a.createElement("div",null,"Name"),r.a.createElement("input",{className:"bg-white border-2 border-gray-200 mt-1 py-2 px-3 mb-1 rounded-md\r w-56 bg-transparent outline-none text-sm",type:"text",name:"name",placeholder:"name...",value:o.name,onChange:function(e){return i(e)}})),r.a.createElement("div",null,r.a.createElement("div",null,"bio"),r.a.createElement("input",{className:"bg-white border-2 border-gray-200 mt-1 py-2 px-3 mb-1 rounded-md\r w-56 bg-transparent outline-none text-sm",type:"text",name:"bio",placeholder:"bio...",value:o.bio,onChange:function(e){return i(e)}})),r.a.createElement("div",null,r.a.createElement("div",null,"phone"),r.a.createElement("input",{className:"bg-white border-2 border-gray-200 mt-1 py-2 px-3 mb-1 rounded-md\r w-56 bg-transparent outline-none text-sm",type:"text",name:"phone",placeholder:"phone...",value:o.phone,onChange:function(e){return i(e)}})),r.a.createElement("div",null,r.a.createElement("div",null,"Location"),r.a.createElement("input",{className:"bg-white border-2 border-gray-200 mt-1 py-2 px-3 mb-1 rounded-md\r w-56 bg-transparent outline-none text-sm",type:"text",name:"location",placeholder:"location...",value:o.location,onChange:function(e){return i(e)}}))),d?r.a.createElement(h,null):r.a.createElement("button",{className:"block w-72 bg-indigo-700 rounded-md text-center text-white font-bold py-2 cursor-pointer mx-auto mt-8"},"Save Changes"),b&&r.a.createElement("p",{className:"font-bold text-red-600 text-sm mt-4 text-center"},b)))))}var D=a(76);function I(e){var t=e.children,a=Object(D.a)(e,["children"]),l=Object(n.useContext)(w),c=l.isLoggedin,o=l.setUser,m=l.setIsLoggedin,u=Object(n.useState)(!1),d=Object(s.a)(u,2),f=d[0],p=d[1];return Object(n.useEffect)((function(){v.a.get("/api/v1/user").then((function(e){200===e.status&&(o(e.data.user),m(!0),p(!0))})).catch((function(e){p(!0),console.log(e)}))}),[]),f&&r.a.createElement(i.b,Object.assign({},a,{render:function(e){var a=e.location;return c?t:r.a.createElement(i.a,{to:{pathname:"/login",state:{from:a}}})}}))}function F(){return r.a.createElement(o.a,null,r.a.createElement(N,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login",exact:!0},r.a.createElement(E,null)),r.a.createElement(i.b,{path:"/register",exact:!0},r.a.createElement(B,null)),r.a.createElement(I,{path:"/messages",exact:!0},r.a.createElement(S,null)),r.a.createElement(I,{path:"/setting",exact:!0},r.a.createElement(H,null)),r.a.createElement(i.a,{from:"/*",to:"/messages"}))))}var U=a(75),V=a.n(U),W=r.a.createContext();function A(e){var t=e.user,a=e.children,l=Object(n.useState)(),c=Object(s.a)(l,2),o=c[0],i=c[1],m=Object(n.useContext)(b),u=m.chat,d=m.setChat,f=m.chatList,p=m.setChatList;return Object(n.useEffect)((function(){if(console.log("useEffect socket provider"),t){console.log("socket connection is ON");var e=V()("http://localhost:5005",{query:{id:t._id,user:t}});return i(e),function(){console.log("socket connection is OFF"),e.close()}}}),[t]),Object(n.useEffect)((function(){if(null!=o)return o.on("receive_message",(function(e){console.log("receiving a message..."),function(e){var t=f.filter((function(t){return t._id!==e.chat})),a=f.find((function(t){return t._id===e.chat}));a?(a.lastMsg=e,t.unshift(a),p(t)):v.a.get("/api/v1/chat?limit=0&offset=10").then((function(e){200===e.status&&p(e.data)})).catch((function(e){return console.log(e)}))}(e),function(e){u&&u._id===e.chat&&d(Object(g.a)(Object(g.a)({},u),{},{messages:[].concat(Object(C.a)(u.messages),[e])}))}(e),o.emit("update_msg_status",{msg:e,status:"delivered"})})),o.on("msg_status_updated",(function(e){var t=e.msg;console.log("Update the message status to ".concat(t.status)),console.log(t),function(e){if(u&&u._id===e.chat){var t=u.messages;t=t.filter((function(t){return!t._id.includes("msg")&&t._id!==e._id})),d(Object(g.a)(Object(g.a)({},u),{},{messages:[].concat(Object(C.a)(t),[e])}))}var a=f.filter((function(t){return t._id!==e.chat})),n=f.find((function(t){return t._id===e.chat}));n?(n.lastMsg=e,a.unshift(n),p(a)):v.a.get("/api/v1/chat?limit=0&offset=10").then((function(e){200===e.status&&p(e.data)})).catch((function(e){return console.log(e)}))}(t)})),function(){o.off("receive_message"),o.off("msg_status_updated")}}),[u,f]),r.a.createElement(W.Provider,{value:o},a)}var P=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),o=Object(s.a)(c,2),i=o[0],m=o[1],u=Object(n.useState)(!1),d=Object(s.a)(u,2),f=d[0],v=d[1],p=Object(n.useState)(null),g=Object(s.a)(p,2),x=g[0],h=g[1],E=Object(n.useState)(null),y=Object(s.a)(E,2),N=y[0],j=y[1],O=Object(n.useState)([]),C=Object(s.a)(O,2),k=C[0],L=C[1];return r.a.createElement(w.Provider,{value:{user:a,isLoggedin:i,isAdmin:f,setUser:l,setIsLoggedin:m,setIsAdmin:v}},r.a.createElement(b.Provider,{value:{chat:x,receiver:N,chatList:k,setChat:h,setReceiver:j,setChatList:L}},r.a.createElement(A,{user:a},r.a.createElement(F,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},77:function(e,t,a){e.exports=a(184)},82:function(e,t,a){}},[[77,1,2]]]);
//# sourceMappingURL=main.d5cb41bf.chunk.js.map